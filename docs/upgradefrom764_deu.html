<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <title>PostNuke Upgrade-Anleitung</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="style.css" type="text/css" media="screen"  />
    </head>

    <body>

        <h1>PostNuke .764 -> Zikula 1.1.1 Upgrade-Anleitung</h1>

        <em><strong>Hinweis: Dieses Dokument beinhaltet wichtige Informationen über das Zikula Application Framework. Bitte vor dem Fortfahren, die Inhalte sorgfältig durchlesen.</strong></em>
        <p>Eine ausführliche und permanent gepflegte Installations- und Upgradeanleitung steht auch im <a href="http://code.zikula.org/community-german/">Deutschen Dokumentationsprojekt</a> zur Verfügung.</p>

        <h2>IMPORTANT</h2>
        <p>These directions are only for upgrading from PostNuke .764 to Zikula 1.1.1. Utilizing a special <strong><a href='http://code.zikula.org/core/wiki/downloads#PostNukeMigrationDistributionbasedon1.1.1'>Migration Distribution</a></strong> created expressly for that purpose. If you are running a version PostNuke previous to .764, you must upgrade to .764 first, then you can follow these instructions. You can upgrade to PostNuke .764 by downloading and installing it from <a href='http://www.postnuke.com/module-Content-view-pid-2.html'>The PostNuke Legacy Site</a>.</p>
        <p>If you are already running any version of Zikula, you need to follow the <a href='upgrade.html'>standard upgrade instructions</a>.</p>
        <p>Zikula continues to be developed and version 1.1.1 is no longer the most current version. After installing this upgrade, you should download the necessary files to upgrade to the most current version of Zikula. These files can be obtained at <a href='http://code.zikula.org/core/wiki/downloads'>code.zikula.org</a>.</p>
        <p>DOWNLOAD the <strong><a href='http://code.zikula.org/core/wiki/downloads#PostNukeMigrationDistributionbasedon1.1.1'>Migration Distribution</a></strong></p>

        <h2>Create A Test Environment</h2>
        <p>This is not an entirely painless process. This will take some time. It is best to test the process out (if possible) before doing it "for real".</p>
        <p>Ideally you will want to leave your current site running while you test your upgrade. So create a test environment. You can set up a local webserver to test. Some people may choose to create a test directory right at their server. This has the advantage of working directly with the same setup as you will be using live.</p>
        <p>When working with your on actual server, you can use the same database, if you just use a different prefix. Doing so will allow you to use the same exact configuration save the prefix.</p>


        <h2 id="Upgrade764">3 Aktualisierung von PostNuke v0.764</h2>
        <p>Bitte die folgenden Schritte in der aufgeführten Reihenfolge abarbeiten und die jeweilige Beschreibung vorab gründlich durchlesen. Werden die Anweisungen befolgt, sollten keine Probleme auftreten.</p>
        <ul>
            <li><a href="#Backup">3.1 Datenbank und Dateisystem sichern</a></li>
            <li><a href="#Prepare">3.2 v0.7x Installation vorbereiten</a></li>
            <li><a href="#Config">3.3 config.php aktualisieren</a></li>
            <li><a href="#Run">3.4 Upgrade durchführen</a></li>
            <li><a href="#Clean">3.5 Aufräumarbeiten</a></li>
        </ul>

        <h3 id="Backup">3.1 Datenbank und Dateisystem sichern</h3>
        <p>Vor dem Upgrade ist es sehr wichtig, ein Backup der v0.7x Datenbank, sowie des Dateisystems anzulegen. Einmal vorgenommene Aktualisierungen können nicht rückgängig gemacht werden, wenn keine Datensicherung vorliegt.
            Eine Sicherung der Datenbank kann beispielsweise über die Tools <a href="http://www.mysqldumper.de/">MySQLDumper</a>, <a href="http://www.phpmyadmin.org">phpMyAdmin</a> oder alternativ über SSH durchgeführt werden.
        Tiefergehende Anleitungen zum Sichern der Datenbanken gibt es zuhauf im Internet und in den Dokumentationen der oben genannten Tools.</p>

        <h3 id="Prepare">3.2 V0.7x Installation vorbereiten</h3>
        <p>Als Administrator in der PostNuke-Seite anmelden und unbedingt sicherstellen, dass die folgenden Module installiert und aktiviert sind:</p>

        <ol>
            <li>Admin</li>
            <li>Admin_Messages</li>
            <li>Blocks</li>
            <li>Groups</li>
            <li>Header_Footer</li>
            <li>legal</li>
            <li>Mailer</li>
            <li>Permissions</li>
            <li>pnRender</li>
            <li>Profile</li>
            <li>Search</li>
            <li>Settings</li>
            <li>User</li>
            <li>Xanthia</li>
        </ol>

        <p>Weitere Module sind optional, da der Core von Zikula auf die notwendigsten Module eingeschränkt wurde. Die sonstigen Module aus einer alten PostNuke-Installation können später getrennt von der Upgraderoutine aktualisiert werden. Dafür steht unter anderem das Paket mit den ValueAddons (Download unter code.zikula.org/core) zur Verfügung. Sobald dieser Schritt abgeschlossen wurde, kann die Datenbank aktualisiert werden.</p>
        <p>Löschen Sie schlussendlich alle Dateien der PostNuke v.07x-Installation, da die Dateistruktur in Zikula enorm verändert wurde. Vorsichtshalber können die Dateien temporär in ein Backup-Verzeichnis ausserhalb der Installation verschoben werden, aus welchen vereinzelt Dateien (Bilder, Downloads, Module, Themes oder Plugins) nach dem erfolgtem Upgrade zurückgesichert werden können. Nachdem sämtliche .7x-Dateien entfernt wurden, können die Dateien von Zikula hochgeladen werden. Bitte beachtem dass das pnTemp-Verzeichnis inkl. Unterverzeichnisse beschreibbar gemacht werden muss (chmod -R 777).</p>

        <h3 id="Config">3.3 config.php aktualisieren</h3>
        <p>Der Speicherort der config.php wurde in das Verzeichnis /config verschoben. In der mitgelieferten Originaldatei müssen in folgende Zeilen die Zugangsdaten für die Datenbank manuell eingepflegt werden:</p>

        <pre>$PNConfig['System']['prefix']
            $PNConfig['DBInfo']['default']['dbuname']
            $PNConfig['DBInfo']['default']['dbpass']
        $PNConfig['DBInfo']['default']['dbname']</pre>

        <p>Wurden verschlüsselte Werte aus der config.php von PostNuke eingefügt, muss folgende Zeile abgeändert werden:</p>
        <pre>$PNConfig['DBInfo']['default']['encoded'] = 1;</pre>

        <p>Weiterhin sollte die folgende Zeile angepasst werden:</p>
        <pre>$PNConfig['System']['installed'] = 1;</pre>

        <p>Wenn nicht mit den Standardwerten gearbeitet wird, wird es in einigen Fällen auch notwendig sein, den Datenbanktyp, Table und Host zu bearbeiten. Das ist jedoch eher die Ausnahme und unter anderem auch Providerabhängig.</p>

        <h3 id="ChangeMigDist">1.35 Changes to Make to the Migration Distribution</h3>
        <p>Improvements have been discovered since the release of the Migration Distribution. The following changes should be made before running the upgrade script.</p>

        <b>system/Users/pninit.php</b>
        <p>Comment out the following lines:</p>
        <pre>function users_migrate_userdatafields76x_post()
            {
            /*
            if (!pnModAvailable('Profile')) {
            return true;
            }
        */</pre>

        <b>modules/Profile/pnversion.php</b>
        <p>Add the following lines after the line containing $modversion['version']</p>
        <pre>$modversion['profile']        = '1';</pre>

        <p><strong><u>Update these modules to the latest version before running an upgrade on these modules:</u></strong></p>
        <b>EZComments</b>
        <p>Update the files of this module to the latest version from <a href='http://community.zikula.org/module-Extensions-display-ot-component-componentid-42.htm'>here</a> before proceeding.</p>

        <b>pnForum</b>
        <p>Update the files of this module to the latest version from <a href='http://community.zikula.org/module-Extensions-display-ot-component-componentid-218.htm'>here</a> before proceeding.</p>

        <b>News</b>
        <p>Update the files of this module to the latest version from <a href='http://community.zikula.org/module-Extensions-display-ot-component-componentid-29.htm'>here</a> before proceeding.</p>


        <h3 id="Run">3.4 Upgrade durchführen</h3>
        <p>Um die Datenbank zu aktualisieren muss die Datei upgrade.php im Browser aufgerufen werden. Hier werden auch Benutzername und Kennwort der vorhandenen PostNuke-Installation benötigt. Danach müssen nur noch die Anweisungen in dem Skript befolgt werden.</p>

        <p><strong>Hinweis:</strong> Zikula entfernt die Fußnachricht (Footer) aus der Admin-Oberfläche. Somit wird eine vorhandene Footer-Nachricht anschließend verschwinden. Es wird empfohlen etwaiger Footer-Nachrichten im Theme fest zu integrieren. Die alte Nachricht wird in Kopie im pnTemp-Verzeichnis abgelegt.</p>

        <p><strong>Hinweis:</strong> Aus Performancegründen sind seit Zikula v1.0 keine Benutzerzugriffsrechte mehr möglich. Es wird empfohlen die Benutzer in einer Gruppe aufzunehmen und darüber die Zugriffsrechte zu verwalten.</p>

        <h3 id="Clean">3.5 Aufräumarbeiten</h3>
        <p>Abschließend müssen die Dateien upgrade.php, install.php und das Install-Verzeichnis aus dem Dateisystem entfernt werden.</p>

        <h2 id="Final">6 Abschlussbemerkung</h2>
        <p>Herzlichen Glückwunsch. Das Upgrade ist vollständig durchgeführt. Wir wünschen viel Spaß mit der neuen Zikula-Version.</p>

        <p>
            <strong>Das deutsche Zikula-Team<br /><a href="http://zikula.de/">zikula.de</a></strong>
        </p>

    </body>
</html>
